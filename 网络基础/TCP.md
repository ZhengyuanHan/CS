## TCP三次握手过程
第一次握手：主机A通过向主机B发送一个含有同步序列号的标志位的数据段给主机B，向主机B请求建立连接，通过这个数据段， 主机A告诉主机B两件事：我想要和你通信；你可以用哪个序列号作为起始数据段来回应我。

第二次握手：主机B收到主机A的请求后，用一个带有确认应答（ACK）和同步序列号（SYN）标志位的数据段响应主机A，也告诉主机A两件事：我已经收到你的请求了，你可以传输数据了；你要用那个序列号作为起始数据段来回应我

第三次握手：主机A收到这个数据段后，再发送一个确认应答，确认已收到主机B的数据段："我已收到回复，我现在要开始传输实际数据了，这样3次握手就完成了，主机A和主机B就可以传输数据了。

### 3次握手的特点
没有应用层的数据，SYN这个标志位只有在TCP建立连接时才会被置1，握手完成后SYN标志位被置0。

### 为什么要三次握手
如果采用两次握手，那么只要服务器发出确认数据包就会建立连接，但由于客户端此时并未响应服务器端的请求，那此时服务器端就会一直在等待客户端，这样服务器端就白白浪费了一定的资源。若采用三次握手，服务器端没有收到来自客户端的再此确认，则就会知道客户端并没有要求建立请求，就不会浪费服务器的资源。

## TCP建立连接要进行3次握手，而断开连接要进行4次
第一次：当主机A完成数据传输后，将控制位FIN置1，提出停止TCP连接的请求；

第二次：主机B收到FIN后对其作出响应，确认这一方向上的TCP连接将关闭，将ACK置1；

第三次：由B端再提出反方向的关闭请求，将FIN置1；

第四次：主机A对主机B的请求进行确认，将ACK置1，双方向的关闭结束。

## TCP报文信息
| TCP报文 | 描述 |
| --- | --- |
| ACK | TCP报头的控制位之一，对数据进行确认。确认由目的端发出， 用它来告诉发送端这个序列号之前的数据段都收到了。 比如确认号为X，则表示前X-1个数据段都收到了，只有当ACK=1时，确认号才有效，当ACK=0时，确认号无效，这时会要求重传数据，保证数据的完整性。 |
| 确认号 | 为服务器发送的上一个数据包中的序列号+该数据包中所带数据的大小。 | 
| SYN | 同步序列号，位于控制字段，防止报文段顺序出错，TCP建立连接时将这个位置1。 |  
| FIN | 位于控制字段，当TCP完成数据传输需要断开时，提出断开连接的一方将这位置1。 |  
| URG | 当URG=1时，表明紧急指针字段有效。它告诉系统此报文段中有紧急数据，应尽快传送（相当于高优先级的数据），而不要按原来的排队顺序来传送。|  
| PSH | 当两个应用进程进行交互式的通信时，有时在一端的应用进程希望在键入一个命令后立即就能收到对方的响应。在这种情况下，TCP就可以使用推送操作。这时，发送方TCP吧push置1，并立即创建一个报文段发送出去。接收方TCP收到PSH=1的报文段，就尽快的（即“推送”向前）交付接收应用程序，而不再等到整个缓存区都填满了之后再向上交付。 |  
| RcvWindow | 接收窗口大小，用于流量控制 |  

## 滑动窗口机制
滑动窗口机制就是以一个N值发送范围内的数据，接收方将乱序的数据先放着缓存区中。而这个时候缓存区的大小就会随着TCP返回给发送方，以便让发送方能调整发送的数据的大小。因此和能够提高传输效率和信道利用率，流量控制有关了 
